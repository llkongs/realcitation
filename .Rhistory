xa
}
twocit(d739)
twocit <- function(data,theta = 1, m = 35){
miny <- min(as.numeric(data[,"py"]))
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
# rownames(xa) <- miny:2014
xa$year <- 1:(2014-min(as.numeric(data[,"py"]))+1)
xa
}
cry <- function(data,year,theta = 1,m = 35){
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]))) {
stop("Invalid year:too small!")
}
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))])    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
twocit(d739)
save.image("F:/Rprojects/data/.RData")
tdz <- twocit(d739)
tdz
mcmodel <- function(x,y,m = 35,data,lambda,mu,sigma){
fit <- nls(y ~ m * (exp(lambda * (pnorm((log(x)-mu)/sigma))-1)),start = list(lambda=lambda,mu=mu,sigma=sigma))
}
mcmodel <- function(x,y,m = 35,data,lambda = 2,mu = 2,sigma = 2){
fit <- nls(y ~ m * (exp(lambda * (pnorm((log(x)-mu)/sigma))-1)),start = list(lambda=lambda,mu=mu,sigma=sigma))
}
mcmodel(year,tc,data = tdz)
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),start = list(a1=3,a2=3,a3=2))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=3,a2=3,a3=2))
fit3
predict(fit3)
summary(fit3)
summary(fit3)
fit4 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=3,a2=3,a3=2))
summary(fit4)
tdz
tdz1 <- tdz[1:4,]
tdz2 <- tdz[5:14,]
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=3,a2=3,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=3,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2,a3=1))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2,a3=4))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2.2,a3=4))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.2,a3=4))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.6,a3=4))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.6,a3=1.5))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.6,a3=1.6))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.6,a3=1.7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.6,a3=1))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=2.6,a3=8))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1.5,a2=6,a3=8))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5,a2=6,a3=8))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5,a2=4,a3=8))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5,a2=4,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5,a2=3.5,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5,a2=3.2,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=3,a2=3.2,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=13,a2=3.2,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=13,a2=3.2,a3=9))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=13,a2=12,a3=9))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=12,a3=9))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=9))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=3))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=4))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=5))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=6))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=3,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=4,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=4,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=3,a2=4,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=4,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=4,a3=3))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=4,a3=4))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=4,a3=5))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=4,a3=6))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=4,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=5,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=6,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=7,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=8,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz2,start = list(a1=8,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=8,a2=6,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=2,a2=3,a3=7))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=2,a2=3,a3=2))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=2,a2=3,a3=3))
fit4 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz,start = list(a1=3,a2=3,a3=3))
fit4
summary(fit4)
summary(fit3)
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=3,a2=3,a3=3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=0.2,a2=3,a3=3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=0.2,a2=0.6,a3=3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=0.2,a2=0.6,a3=0.2))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=0.2,a2=0.6,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=0.2,a2=0.6,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=0.2,a2=2.6,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2.2,a2=2.6,a3=1.3))
summary(fit4)
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4.5,a2=1.5,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5.5,a2=1.5,a3=0.8))
tdz1
fit4 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5.5,a2=1.5,a3=0.8))
summary(fit4)
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5.5,a2=0.5,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=5.5,a2=0.5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4.5,a2=0.5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2.5,a2=0.5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2.1,a2=0.5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=0.5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=0.5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=0.005,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=0.005,a3=0.003))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=0.01,a3=0.003))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=0.01,a3=0.03))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=0.01,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=222,a2=0.01,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=0.01,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=11,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=11,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=21,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=4,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=5,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=5,a3=0.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=5,a3=1.3))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=32,a2=5,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=42,a2=5,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=5,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=3,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=3,a2=3,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=12,a2=3,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=12,a2=13,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=12,a2=23,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=12,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=22,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=26,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=16,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=17,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=18,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=19,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=20,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=4,a3=0.8))
tdz
tdz1 <- tdz[1:5,]
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=4,a3=0.8))
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=0.8))
summary(fit3)
predict(fit3,tdz2)
predict(fit4,tdz2)
tdz
summary(fit4)
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=1,a2=2,a3=0.8))
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2,a3=0.8))
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=3,a3=0.8))
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=2,a2=2,a3=0.8))
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=2,a3=0.8))
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=0.8,a3=0.8))
summary(fit3)
predict(fit3,tdz2)
tdz2
tdz1 <- tdz[1:8,]
fit3 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=0.8,a3=0.8))
predict(fit3,tdz2)
tdz2
tdz2 <- tdz[9:14,]
predict(fit3,tdz2)
fit3 <- nls(rc ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=0.8,a3=0.8))
predict(fit3,tdz2)
summary(fit3)
preditc(fit3)
predict(fit3)
tdz1
fit4 <- nls(ct ~ 40 * (exp(a1 * (pnorm((log(year)-a2)/a3))-1)),data = tdz1,start = list(a1=4,a2=0.8,a3=0.8))
summary(fit4)
predict(fit4)
plot(tdz$rc)
tdz$rc
plot(1:14,tdz$rc)
plot(1:14,tdz$rc,ylim = c(0,1000))
lines(1:14,tdz$ct)
lines(1:14,predict(fit3,tdz),col = "red")
lines(1:14,predict(fit4,tdz),col = "blue")
lines(1:14,tdz$rc, col = "blue")
lines(1:14,tdz$ct, col = "red")
tdz
summary(fit3)
sumamry(fit4)
summary(fit4)
tdz1
predict(fit3,tdz2)
predict(fit4,tdz2)
d492 <- rsdata(rdxlsx("492.xlsx",1,493)
)
twocit(d492)
mcmodel
mcmodel <- function(x,y,m = 35,data,lambda = 2,mu = 2,sigma = 2){
fit <- nls(y ~ m * (exp(lambda * (pnorm((log(x)-mu)/sigma))-1)),start = list(lambda=lambda,mu=mu,sigma=sigma))
fit
}
```
fit5 <- mcmodel("year","rc",data = twocit(d492))
cd492 <-twocit(d492)
cd492
fit5 <- mcmodel("year","rc",data = cd492
)
)
fit5 <- mcmodel(year,rc,data = cd492)
fit <- nls(y ~ m * (exp(lambda * (pnorm((log(x)-mu)/sigma))-1)),start = list(lambda=lambda,mu=mu,sigma=sigma))
lambda <- 2;mu=2;sigma = 2
fit <- nls(y ~ m * (exp(lambda * (pnorm((log(x)-mu)/sigma))-1)),start = list(lambda=lambda,mu=mu,sigma=sigma))
m <- 40
fit <- nls(y ~ m * (exp(lambda * (pnorm((log(x)-mu)/sigma))-1)),start = list(lambda=lambda,mu=mu,sigma=sigma))
fit5 <- nls(cr ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492,start = list(lambda=2,mu=2,sigma=2))
cd492
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492,start = list(lambda=2,mu=2,sigma=2))
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492,start = list(lambda=3,mu=2,sigma=2))
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492,start = list(lambda=3,mu=3,sigma=2))
summary(fit5)
cd492
cd492_train <- cd492[1:8,]
cd492_test <- cd492[9:14,]
?nls
formu1 <- rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1))
formu2 <- ct ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1))
fitct492 <- nls(formu1,data= cd492,start = list(la = 2,mu=2,si = 2 ))
fitct492 <- nls(formu1,data= cd492,start = list(la = 3,mu=2,si = 2 ))
fitct492 <- nls(formu1,data= cd492,start = list(la = 4,mu=2,si = 2 ))
fitct492 <- nls(formu1,data= cd492,start = list(la = 4,mu=2,si=0.2))
fitct492 <- nls(formu1,data= cd492,start = list(la = 2,mu=2,si=0.2))
fitct492 <- nls(formu1,data= cd492,start = list(la = 2,mu=1,si=0.2))
fitct492 <- nls(formu1,data= cd492,start = list(la = 1,mu=1,si=0.2))
fit5
fitct492 <- nls(formu1,data= cd492,start = list(la = 4,mu=1,si=0.2))
fitct492 <- nls(formu1,data= cd492,start = list(la = 4,mu=1,si=0.7))
fitct492 <- nls(formu1,data= cd492,start = list(la = 4,mu=1.5,si=0.7))
fitct492 <- nls(formu1,data= cd492,start = list(la = 4.2,mu=1.5,si=0.7))
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492_test,start = list(lambda=3,mu=2,sigma=2))
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492_test,start = list(lambda=4,mu=2,sigma=2))
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),data = cd492_test,start = list(lambda=4,mu=2,sigma=1))
summary(fit5)
fitct492 <- nls(formu1,data= cd492_test,start = list(la = 4.2,mu=1.5,si=0.7))
fitct492 <- nls(formu1,data= cd492_test,start = list(la = 4,mu=2,si=1))
fitct492 <- nls(formu1,cd492_test,start = list(la = 4,mu=2,si=1))
fit5 <- nls(rc ~ 35 * (exp(lambda * (pnorm((log(year)-mu)/sigma))-1)),cd492_test,start = list(lambda=4,mu=2,sigma=1))
summary(fit)
fit5 <- nls(formu1,cd492_test,start = list(lambda=4,mu=2,sigma=1))
fitct492 <- nls(formu1,cd492_test,start = list(lambda=4,mu=2,sigma=1))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=4,mu=2,sigma=1))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=2,mu=2,sigma=1))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=2,mu=1,sigma=1))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=6,mu=1,sigma=1))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=6,mu=2,sigma=1))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=6,mu=2,sigma=2))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=6,mu=2,sigma=0.7))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=6,mu=1.2,sigma=0.7))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=2,mu=1.2,sigma=0.7))
fitrt492 <- nls(formu2,cd492_test,start = list(lambda=2,mu=2,sigma=0.7))
summary(fitct492)
predict(fitct492,cd492_train)
fitct492 <- nls(formu1,cd492_train,start = list(lambda=4,mu=2,sigma=1))
summary(fitct492)
predict(fitct492,cd492_test)
cd492
d1452 <- rsdata(rdxlsx("1452.xlsx",1,1453))
d1330 <- rsdata(rdxlsx("1330.xlsx",1,1331))
cd1452 <- twocit(d1452)
table(d1452[,"py"])
min(as.numeric(d1452[,"py"]))
summary(d1452[,"py"])
twocit <- function(data,theta = 1, m = 35){
miny <- min(as.numeric(data[,"py"]),na.rm = TRUE)
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
xa$year <- 1:(2014-min(as.numeric(data[,"py"]))+1)
xa
}
cd1452 <- twocit(d1452)
cry <- function(data,year,theta = 1,m = 35){
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]))) {
stop("Invalid year:too small!")
}
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))],na.rm = TRUE)    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
cd1452 <- twocit(d1452)
min(as.numeric(d1452[,"py"]))
min(as.numeric(d1452[,"py"],na.rm = TRUE))
min(as.numeric(d1452[,"py"]),na.rm = TRUE)
miny <- min(as.numeric(d1452[,"py"]),na.rm = TRUE)
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
cry(d1452,2008)
cry <- function(data,year,theta = 1,m = 35){
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]),na.rm = TRUE)) {
stop("Invalid year:too small!")
}
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))],na.rm = TRUE)    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
cry(d1452,2008)
which(d1452[,"py"] == NA)
table(d1452[,"py"])
sum(d1452[,"py"] == NA)
d1452[,'py'] == NA
d1452[,'py']
d1452[,'py'] == NaN
d1452[,'py'] == na
is.na(d1452[,"py"])
which(is.na(d1452[,"py"]))
c1 <- which(is.na(d1452[,"py"]))
d1452[-c1,]
d1452 <- d1452[-c1,]
sum(is.na(d1452[,"py"]))
cry(d1452,2008)
twocit(d1452)
cry <- function(data,year,theta = 1,m = 35){
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]),na.rm = TRUE)) {
stop("Invalid year:too small!")
}
c1 <- which(is.na(data[,"py"]))
data <- data[-c1,]
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))],na.rm = TRUE)    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
cry <- function(data,year,theta = 1,m = 35){
c1 <- which(is.na(data[,"py"]))
data <- data[-c1,] #delete the data that have no pulication years
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]),na.rm = TRUE)) {
stop("Invalid year:too small!")
}
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))],na.rm = TRUE)    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
d1452 <- rsdata(rdxlsx("1452.xlsx",1,1453))
twocit(d1452)
twocit <- function(data,theta = 1, m = 35){
c1 <- which(is.na(data[,"py"]))
data <- data[-c1,] #delete the data that have no pulication years
miny <- min(as.numeric(data[,"py"]),na.rm = TRUE)
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
xa$year <- 1:(2014-min(as.numeric(data[,"py"]))+1)
xa
}
twocit(d1452)
cry(d1452,1990)
min(as.numeric(d1452[,"py"]))
c1 <- which(is.na(data[,"py"]))
c1 <- which(is.na(d1452[,"py"]))
d1452 <- d1452[-c1,]
min(as.numeric(d1452[,"py"]))
min(as.numeric(d1452[,"py"]),na.rm = TRUE)
twocit <- function(data,theta = 1, m = 35){
c1 <- which(is.na(data[,"py"]))
data <- data[-c1,] #delete the data that have no pulication years
miny <- min(as.numeric(data[,"py"]),na.rm = TRUE)
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
xa$year <- 1:(2014-min(as.numeric(data[,"py"]))+1)
xa
}
twocit(1452)
d1452[,"py"]
twocit(1571)
twocit(d1452)
twocit(d1571)
cry(d1571,2008)
min(as.numeric(d1571[,"py"])
)
cry(d1571,2009)
min(as.numeric(d1452[,"py"]))
min(as.numeric(d571[,"py"]))
min(as.numeric(d1571[,"py"]))
which(is.na(d1571[,"py"]))
d1571[-0,]
d1571 <- d1571[!is.na(d1571[,"py"]),]
cry <- function(data,year,theta = 1,m = 35){
data <- data[!is.na(data[,""]),] #delete the data that have no pulication years
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]),na.rm = TRUE)) {
stop("Invalid year:too small!")
}
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))],na.rm = TRUE)    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
twocit <- function(data,theta = 1, m = 35){
data <- data[!is.na(data[,""]),] #delete the data that have no pulication years
miny <- min(as.numeric(data[,"py"]),na.rm = TRUE)
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
xa$year <- 1:(2014-min(as.numeric(data[,"py"]))+1)
xa
}
twocit(d1571)
cry <- function(data,year,theta = 1,m = 35){
data <- data[!is.na(data[,"py"]),] #delete the data that have no pulication years
year <- as.numeric(year)
if(year < min(as.numeric(data[,"py"]),na.rm = TRUE)) {
stop("Invalid year:too small!")
}
ydata <- subset(data, py <= year) # find the necessary articles
n1 <- dim(ydata)[1] #find number of articles
n2 <- dim(ydata)[2] # number of columns
h <- vector() #storage the citation of each paper
for (i in 1:n1){
puby <- as.numeric(ydata[i,"py"])
h[i] <- sum(ydata[i,(122-(2015-puby)):(122-(2015-year))],na.rm = TRUE)    # count number of citaitons till this year
}
cdata <- NULL
cdata$rc <- round(sum(log((3*h/m)^theta+1)),3)
cdata$ct <- n1 #ordinary citation
as.data.frame(cdata)
}
twocit <- function(data,theta = 1, m = 35){
data <- data[!is.na(data[,"py"]),] #delete the data that have no pulication years
miny <- min(as.numeric(data[,"py"]),na.rm = TRUE)
xa <- NULL
for (year in miny:2014){
xa <- rbind(xa,cry(data,year,theta,m))
}
xa$year <- 1:(2014-min(as.numeric(data[,"py"]))+1)
xa
}
twocit(d1571)
d1452 <- rsdata(rdxlsx("1452.xlsx",1,1453))
twocit(d1452)
save.image("F:/Rprojects/data/.RData")
